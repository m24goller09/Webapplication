#!/bin/sh
# Nonzero exit status aborts commit
# Working directory is repository root

# Only test what is going to be commited
git stash --quiet --keep-index

branch=$(git branch --show-current)
if test $branch = API; then
	# Test build
	cd API
	dotnet build
	exitstatus=$?
	test $exitstatus -eq 0 || echo Build failed, aborting commit
fi

git stash pop --quiet

exit $exitstatus
